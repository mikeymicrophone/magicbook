<p id="notice"><%= notice %></p>

<p>
  <strong>Title:</strong>
  <%= @book.title %>
</p>

<p>
  <strong>Version:</strong>
  <%= @book.version %>
</p>

<p>
  <strong>Pdf:</strong>
  <%= @book.pdf %>
</p>

<p>
  <strong>Author:</strong>
  <%= @book.author %>
</p>

<%= link_to 'Edit', edit_book_path(@book) %> |
<%= link_to 'Back', books_path %>

<% edition = @book.editions.last %>
<%= div_with_data_for edition do %>
  <%= content_tag :header do %>
    version <%= edition.version %>
  <% end %>
  <%= focus_append_on edition %>
  <% @book.table_of_contents.in_edition(edition).chapterish.order(:ordering).map(&:chapter).each do |chapter| %>
    <%= div_with_data_for chapter do %>
      <%= content_tag :header do %>
        <%= chapter.title %>
      <% end %>
      <%= chapter.subtitle %>
      <% @book.table_of_contents.in_edition(edition).in_chapter(chapter).sectionish.order(:ordering).map(&:section).each do |section| %>
        <%= div_with_data_for section do %>
          <%= content_tag :header do %>
            <%= section.heading %>
          <% end %>
          <%= section.subheading %>
          <% @book.table_of_contents.in_edition(edition).in_chapter(chapter).in_section(section).paragraphish.order(:ordering).map(&:paragraph).each do |paragraph| %>
            <%= div_with_data_for paragraph do %>
              <%= paragraph.text %>
              <% @book.table_of_contents.in_edition(edition).in_chapter(chapter).in_section(section).in_paragraph(paragraph).citationish.order(:ordering).map(&:citation).each do |citation| %>
                <%= div_with_data_for citation do %>
                  <%= citation.finding %>
                  <%= citation.source %>
                <% end %>
              <% end %>
            <% end %>
          <% end %>
        <% end %>
      <% end %>
    <% end %>
  <% end %>
<% end %>
